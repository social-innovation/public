## 算法类工作规范-代码目录组织


### 目录

方式一：一个版本库放置一个算法模块
```
|- input_data # 放置输入数据文件的目录
   |- xxx.json # 输入数据 json 文件
   |- xxx.csv # 输入数据 csv 文件
|- output_data # 放置输出数据文件的目录
   |- xxx.json # 输出数据 json 文件
   |- xxx.csv # 输出数据 csv 文件
|- lib # 这里放其余的代码文件（如果有）
|- doc # 这里放其余的参考文档（如果有）
|- main.py # 实现的算法代码程序文件
|- README.md # 说明文件索引
|- INPUT_DATA.md # 输入数据格式说明
|- OUTPUT_DATA.md # 输出数据格式说明
|- CONSTANT.md # 算法中用到的常量说明
|- CONDITION.md # 算法入口方法 condition 参数的结构说明
|- requirements.txt # 依赖的 Python 库
```

方式二：一个版本库放置多个算法模块
```
|- <算法模块一> # 命名需全小写加横线，al 开头，例如：al-text-parser
    |- input_data # 放置输入数据文件的目录
       |- xxx.json # 输入数据 json 文件
       |- xxx.csv # 输入数据 csv 文件
    |- output_data # 放置输出数据文件的目录
       |- xxx.json # 输出数据 json 文件
       |- xxx.csv # 输出数据 csv 文件
    |- lib # 这里放其余的代码文件（如果有）
    |- doc # 这里放其余的参考文档（如果有）
    |- main.py # 实现的算法代码程序文件
    |- README.md # 说明文件索引
    |- INPUT_DATA.md # 输入数据格式说明
    |- OUTPUT_DATA.md # 输出数据格式说明
    |- CONSTANT.md # 算法中用到的常量说明
    |- CONDITION.md # 算法入口方法 condition 参数的结构说明
    |- requirements.txt # 依赖的 Python 库
|- <算法模块二> # 若有多个算法模块，每个的目录组织是类似的
|- <算法模块三> 
|- ...
```

### main.py 代码结构
```
# 必须包含这个 SERVICE_NAME 变量，声明该算法模块的名称，这个变量会被消息队列消费端引用到
# 变量取值一般设置为算法模块名称即可
SERVICE_NAME = "al-xxx-xxx"

# 比如以这个方法为算法计算入口
def al_run(input_data, condition):
    """
    必须声明这个方法，这个方法会被 消息队列消费端 引用到
    :param input_data: 算法模块需要的输入数据，字典类型
    :param condition: 算法模块需要的输入参数，字典类型
    :return: result: 算法模块运行结果
    """
    if condition["type"] == TYPE_ONE:
        numpy.random.random()
        return {
            "success": True,
            "output_data": input_data["a"]
        }

    if condition["type"] == TYPE_ALL:
        return {
            "success": True,
            "output_data": input_data["a"]
        }

    return {
        "success": False,
        "output_data": {
            "error": "参数错误"
        }
    }
    
# 这里是单独开发使用的运行方式 python main.py <input_file_path> <type>
if __name__ == "__main__":
    args = sys.argv[1:]
    input_file_path = args[0]
    _type = args[1]

    with open(input_file_path, "r") as f:
        input_data = json.load(f)

    result = al_run(input_data, {"type": _type})

    if result["success"]:
        with open("./output_data/output.json", "w") as f:
            json.dump(result["output_data"], f)
    else:
        print(result["output_data"]["error"])
```

### README 文档格式
[README 文档格式](./README-文档格式.md)

### CONSTANT 文档格式
[CONSTANT 文档格式](./CONSTANT-文档格式.md)

### CONDITION 文档格式
[CONDITION 文档格式](./CONDITION-文档格式.md)

### INPUT_DATA 文档格式
[INPUT_DATA 文档格式](./INPUT_DATA-文档格式.md)

### OUTPUT_DATA 文档格式
[OUTPUT_DATA 文档格式](./OUTPUT_DATA-文档格式.md)